@using Model.ViewModels
@model ViewModelHomePage
@{
    ViewData["Title"] = "Post View";
    int idPostForComment = 0;
    var imgaddress = "";
}
@if (ViewBag.Error != null)
{
    <script>alert(@ViewBag.Error)</script>
}
@if (Model.checkThemDictionary!["ViewPost"] == true)
{
    foreach (var item in Model.sectionPostSteps!)
    {
        idPostForComment = item.Id;
        <div class="ViewPostMain">
            <div class="viewlearnpic">
                @foreach (var imageitem in Model.sectionPostImages!.Where(m => m.Id_SectionPostStep == item.Id))
                {
                    <div class="mySlides">
                        @{
                            imgaddress = @"/Images/ImageLarge/" + imageitem.PictureAddress;
                                    <img class="imglearn" src=@imgaddress alt="@imageitem.TagsName" />
                        }
                    </div>
                }
                <div class="top-right">  @item.Title  </div>
                <div class="bottom-right">  @item.ShortDescription  </div>
                <div class="top-left"> <div class="divline"><img src="~/Images/ImageThem/Icon/TimeImage.png">  @item.CreateDate.ToString("HH:mm -MM/dd/yyyy")  </div></div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="divline"> @Html.Raw(@item.FullDescription) </div>

                </div>
            </div>
            <div class="viewcontainerindextitleright">
                <div class="btn btn-info">تەگەکان  ▼ </div>
            </div>
            <div class="row">

                @{
                    string[] tags = item.TagsName!.Split("#");
                }

                @foreach (string s in tags)
                {
                    <div class="col-md-3">
                        <div class="divtags"> @s.ToString() </div>
                    </div>
                }

            </div>
          
        </div>
       
        @if (Model.sectionPostVideos!.Count() > 0)
        {
            @foreach (var video in Model.sectionPostVideos!)
            {
                <div class="sectionscontainer">
                    <div class="containerindex">
                        <div class="viewcontainerindextitleright">
                            <div class="btn btn-info">ویدیۆکان  ▼ </div>
                        </div>
                    </div>
                    <div id="viewlearnhomeright"style="height:auto;">

                        @if (video.SectionPostSocialVideo!.Title == "YouTube")
                        {
                            <div class=" imagesection">
                                <div class="videodisplay">
                                    <iframe class="videodisplay" src="@video.VideoAddress" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                        }

                        @if (video.SectionPostSocialVideo!.Title == "FaceBook")
                        {
                            <div class=" imagesection"style="height:auto;">
                                <div class="videodisplay">
                                    <iframe class="videodisplay" src="@video.VideoAddress" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowfullscreen="true" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share" allowFullScreen="true"></iframe>
                                </div>
                            </div>
                        }
                        @if (video.SectionPostSocialVideo!.Title == "Telegram")
                        {
                            <div class=" imagesection"style="height:auto;">
                                <div class="videodisplay">
                                    <script async src="https://telegram.org/js/telegram-widget.js?21" data-telegram-post="@video.VideoAddress" data-width="100%" data-height="100%"></script>
                                </div>
                            </div>
                        }
                        <div class="viewlearnhomerightiner">
                            <div class="viewlearn-lefthome">
                                <div class="divlinetitle">◄◄@video.Title   </div>
                                <div class="divline"><img src="~/Images/ImageThem/Icon/TimeImage.png"> @item.CreateDate.ToString("HH:mm -MM/dd/yyyy")  </div>
                            </div>
                        </div>

                    </div>
                </div>
            }

        }
        @if (Model.checkThemDictionary != null)
        {
            @if (Model.checkThemDictionary["RelatedPost"] == true)
            {
                <div class="newscontainer" style="margin-right:0px;">
                    <div class="containerindex">
                        <div class="viewcontainerindextitleright">

                            <div class="btn btn-info"> پۆستە پەیوەندی دارەکان  ▼ </div>
                        </div>
                    </div>
                    <div id="viewlearnhomeright">
                        @foreach (var relatedpost in Model.sectionPostTopMostRelatedSteps!)
                        {
                            <div class="viewlearnhomerightiner">
                                <div class="viewlearn-lefthome">
                                    <div class="divlinetitle">◄◄@Html.ActionLink(@relatedpost.ShortDescription, "PostView", new { idPost = relatedpost.Id })   </div>
                                    <div class="divline"><img src="~/Images/ImageThem/Icon/TimeImage.png"> @relatedpost.CreateDate.ToString("HH:mm -MM/dd/yyyy")  </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>

            }
        }
        @if (Model.checkThemDictionary!["ViewComment"] == true)
        {

            <div id="viewanswer">
                <div class="viewcontainerindextitleright">
                    <div class="btn btn-info"><img src="~/Images/ImageThem/Icon/Comment.png">  &nbsp کۆمێنتەکان  ▼ </div>
                </div>
                @foreach (var comment in Model.sectionPostComments!)
                {
                    <div class="divtitlecomment "><img src="~/Images/ImageThem/Icon/User.png">  &nbsp @Html.Raw(@comment.Name) :</div>
                    <div class="divtextcomment"> @Html.Raw(@comment.Comment)</div>
                    @foreach (var answer in Model.sectionPostAnswers!.Where(m => m.Id_SectionPostCommentStep == comment.Id))
                    {
                        <div class="divanswercomment"><span><img src="~/Images/ImageThem/Icon/User.png">  &nbsp @answer.Name ◄  </span>@Html.Raw(answer.Answer)</div>
                    }
                }
            </div>
        }
        @if (Model.checkThemDictionary!["InsertComment"] == true)
        {
            @using (Html.BeginForm("PostInsertComment", "Home", FormMethod.Post, new { id = "form" }))
            {
                @Html.AntiForgeryToken()
                <div class="viewcomment">
                    <div id="message"> </div>
                    <div class="form-group">
                        @Html.Label("ناۆ")
                        <div class="col-md-12">
                            @Html.TextBox("userName", "", new { @class = "form-control", required = "required", oninvalid = "this.setCustomValidity('تکایە فۆرمەکە پر کەوە')", oninput = "setCustomValidity('')" })
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.Label("ئیمەێل")
                        <div class="col-md-12">
                            @Html.TextBox("mailAddress", "", new { @class = "form-control", type = "email", required = "required", oninvalid = "this.setCustomValidity('تکایە ئیمەێلەکە بە دروستی پر کەوە')", oninput = "setCustomValidity('')" })
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.Label("پەیام")
                        <div class="col-md-12">
                            @Html.TextArea("commentText", "", new { @class = "form-control", required = "required", oninvalid = "this.setCustomValidity('تکایە فۆرمەکە پر کەوە')", oninput = "setCustomValidity('')" })
                        </div>
                    </div>
                    @Html.Hidden("idPost", idPostForComment)
                    <div class=" insertcomment">
                        <input type="submit" value="دانان" class="downloadbuttonhome" />
                    </div>
                </div>

            }
        }
        
    }
}
@section Scripts {
    <script type="text/javascript" src="~/js/PostView.js"></script>
}

